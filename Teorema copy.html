<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teorema del Valor Medio</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.1/math.js"></script>
</head>
<body>
    <h1>Teorema del Valor Medio</h1>
    <div>
        <label for="funcion-fx">Función f(x):</label>
        <input type="text" id="funcion-fx">
    </div>
    <div>
        <label for="extremo-a">Extremo a:</label>
        <input type="number" id="extremo-a">
    </div>
    <div>
        <label for="extremo-b">Extremo b:</label>
        <input type="number" id="extremo-b">
    </div>
    <button onclick="calcularTeoremaValorMedio()">Calcular</button>
    <div id="resultado"></div>
    <div id="grafica"></div>

    <script>
        google.charts.load('current', {'packages':['corechart']});

        function calcularTeoremaValorMedio() {
            var a = parseFloat(document.getElementById("extremo-a").value);
            var b = parseFloat(document.getElementById("extremo-b").value);
            var funcionStr = document.getElementById("funcion-fx").value;

            if (!isNaN(a) && !isNaN(b) && a < b && funcionStr !== "") {
                var mathParser = math.parser();
                mathParser.evaluate('funcion(x) = ' + funcionStr);

                var valorMedio = mathParser.evaluate('(funcion(' + b + ') - funcion(' + a + ')) / (b - a)');
                document.getElementById("resultado").innerHTML = "El valor medio de la función f(x) en el intervalo [" + a + ", " + b + "] es: " + valorMedio.toFixed(2);

                generarGrafica(a, b, mathParser.get('funcion'));
            } else {
                document.getElementById("resultado").innerHTML = "Por favor, ingrese valores numéricos para los extremos a y b, y asegúrese de que a < b. Además, ingrese una función válida.";
            }
        }

        function generarGrafica(a, b, funcion) {
            var data = new google.visualization.DataTable();
            data.addColumn('number', 'x');
            data.addColumn('number', 'f(x)');

            var paso = 0.1;

            for (var x = a; x <= b; x += paso) {
                data.addRow([x, funcion(x)]);
            }

            var options = {
                title: 'Gráfica de f(x)',
                curveType: 'function',
                width: 600,
                height: 400
            };

            var chart = new google.visualization.LineChart(document.getElementById('grafica'));
            chart.draw(data, options);
        }

        google.charts.setOnLoadCallback(function() {
            // Aquí puedes realizar cualquier otra inicialización necesaria
        });
    </script>
</body>
</html>
